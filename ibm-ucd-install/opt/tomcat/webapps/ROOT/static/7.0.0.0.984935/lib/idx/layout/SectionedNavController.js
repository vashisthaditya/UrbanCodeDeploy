//>>built
define("idx/layout/SectionedNavController","dojo/_base/declare,dijit/_Widget,dijit/registry,dojo/_base/event,dojo/_base/connect,dojo/_base/lang,dojo/keys".split(","),function(k,l,h,j,f,g,e){return k("idx.layout.SectionedNavController",[l],{id:"",associatedGrids:"",_associatedGrids:[],_lastGridSelected:"",_lastRowSelected:-1,constructor:function(a){this.id=a.id},_setAssociatedGridsAttr:function(a){this.associatedGrids=a;this._started&&this._connectToGrids()},startup:function(){this.inherited(arguments);
this._connectToGrids()},_connectToGrids:function(){if(this._gridConnections){for(var a=0;a<this._gridConnections.length;a++){var b=this._gridConnections[a];b&&(f.disconnect(b),this._gridConnections[a]=null)}delete this._gridConnections}this._associatedGrids=this.associatedGrids.split(",");this._gridConnections=[];this._pendingGrids={};for(a=0;a<this._associatedGrids.length;a++){var b=this._associatedGrids[a],c=h.byId(b);c?this._connectToGrid(b,c):this._pendingGrids[b]=f.connect(h,"add",g.hitch(this,
function(a,b){b.id==a&&this._connectToGrid(b.id,b)},b))}},_connectToGrid:function(a,b){var c=this._pendingGrids[a];c&&(f.disconnect(c),delete this._pendingGrids[a]);b.canSort=function(){return!1};var c={owner:this,grid:b},d=f.connect(b,"onSelected",g.hitch(c,function(a){this.owner._handleSelect(this.grid,a)}));this._gridConnections.push(d);d=f.connect(b,"onCellFocus",g.hitch(c,function(a,b){this.owner._handleFocus(this.grid,a,b)}));this._gridConnections.push(d);d=f.connect(b,"onKeyEvent",g.hitch(c,
function(a){this.owner._handleKey(this.grid,a)}));this._gridConnections.push(d)},_handleKey:function(a,b){var c="_handle_"+b.dispatch;if(c in this)this[c](a,b)},_handle_dokeydown:function(a,b){switch(b.keyCode){case e.UP_ARROW:case e.DOWN_ARROW:case e.LEFT_ARROW:case e.RIGHT_ARROW:break;default:return}var c=a.focus.cell,d=a.focus.rowIndex;c&&!(0>d)&&(0>a.selection.selectedIndex?a.selection.select(d):c.getNode(d).focus(),j.stop(b))},_handle_dokeyup:function(a,b){switch(b.keyCode){case e.UP_ARROW:case e.DOWN_ARROW:case e.LEFT_ARROW:case e.RIGHT_ARROW:return}var c=
a.focus.cell,d=a.focus.rowIndex;c&&!(0>d)&&(0>a.selection.selectedIndex?a.selection.select(d):c.getNode(d).focus(),j.stop(b))},_handle_dokeypress:function(a,b){if(!(8!=dojo.isIE&&9!=dojo.isIE||b.altKey||b.ctrlKey)){switch(b.keyCode){case e.UP_ARROW:case e.DOWN_ARROW:case e.LEFT_ARROW:case e.RIGHT_ARROW:break;default:return}var c=a.focus.cell;c||(c=a.getCell(0));var d=a.focus.rowIndex;0>d&&(d=0);c.getNode(d).focus();j.stop(b)}},_handleFocus:function(a,b,c){if(this._internalCall)this._internalCall=
!1;else if(!(0>c)&&(a.selection.select(c),b.getNode(c),!a.focus.isFocusCell(b,c)))this._internalCall=!0,a.focus.setFocusCell(b,c)},_handleSelect:function(a,b){for(i=0;i<this._associatedGrids.length;i++){var c=this._associatedGrids[i];c!=a.id&&(c=h.byId(c))&&c.selection.clear()}if(this._lastGridSelected!=a.id||this._lastRowSelected!=b)this._lastGridSelected=a.id,this._lastRowSelected=b,f.publish(this.id+"-selectionChanged",[{grid:a,rowIndex:b}])}})});