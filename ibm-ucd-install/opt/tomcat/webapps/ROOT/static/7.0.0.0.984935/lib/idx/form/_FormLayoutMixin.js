//>>built
define("idx/form/_FormLayoutMixin","dojo/_base/declare,dojo/_base/lang,dojo/_base/array,dojo/dom-construct,dojo/query,dijit/registry".split(","),function(l,n,c,j,k,m){return l("idx.form._FormLayoutMixin",null,{rows:null,columns:null,rowWidth:"600px",forceRows:!1,postMixInProperties:function(){this.inherited(arguments);this.children=this.children||[];if(this.columns){if("number"==typeof this.columns){for(var a=[],b=0;b<this.columns;b++)a.push({labelWidth:"120px",fieldWidth:"180px"});this.columns=a}if(this.rows instanceof
Array)this.rows=c.map(this.rows,function(){return{itemNumber:this.columns.length,node:this._newRow()}},this)}else if(this.rows instanceof Array)this.rows=c.map(this.rows,function(a){return{itemNumber:a,node:this._newRow()}},this)},addChild:function(a,b,d){if(a=m.byId(a)){if("undefined"==typeof b)b=this._lastRowIndex();else if(this._isRowFilled(b))return;var e=this.rows?this.rows[b]:null,d="undefined"==typeof d?this.getWidgetsInRow(b).length:d;if(!e||!(e.itemNumber&&e.itemNumber<=d))if(e)this.children.push({row:b,
index:d,item:a});else if(!this.rows||!this.forceRows&&b==this.rows.length){e={itemNumber:this.columns?this.columns.length:"",node:this._newRow()};this.children.push({row:b,index:d,item:a});if(!this.rows)this.rows=[];this.rows.push(e)}}},_lastRowIndex:function(){if(!this.rows||0==this.rows.length)return 0;for(var a=this.rows.length;0==this.getWidgetsInRow(a).length&&0<a&&!this._isRowFilled(a-1);)a--;return a},_isRowFilled:function(a){if(this.rows&&this.rows[a]){var b=this.rows[a].itemNumber;return b&&
this.getWidgetsInRow(a).length==b}return!1},_setChildrenAttr:function(a){this.children=[];c.forEach(a,function(a){this.addChild(a)},this)},_setColumnsAttr:function(a){if("number"==typeof a){this.columns=[];for(var b=0;b<a;b++)this.columns.push({labelWidth:"120px",fieldWidth:"180px"})}else if(a instanceof Array)this.columns=a;else return;this.rows=this.forceRows?c.map(this.rows instanceof Array?this.rows:Array(this.rows),function(){return{itemNumber:this.columns.length,node:this._newRow()}},this):
null;this.children.sort(function(a,b){return 0<a.row-b.row||a.row==b.row&&a.index>b.index});a=c.map(this.children,function(a){return a.item});this.children=[];this.set("children",a)},_setRowsAttr:function(a){this.forceRows=null!=a;if(a instanceof Array)this.columns=null,this.rows=c.map(a,function(a){return{itemNumber:a,node:this._newRow()}},this);else if("number"==typeof a)this.rows=c.map(Array(a),function(){return{itemNumber:this.columns?this.columns.length:"",node:this._newRow()}},this)},setLabelWidthInColumn:function(a,
b){if(this.columns&&!(this.columns.length<=a)){var d=this.getWidgetsInColumn(a);c.forEach(d,function(a){a.set("labelWidth",b)});this.columns[a].labelWidth=b}},setFieldWidthInColumn:function(a,b){if(this.columns&&!(this.columns.length<=a)){var d=this.getWidgetsInColumn(a);c.forEach(d,function(a){a.set("fieldWidth",b)});this.columns[a].fieldWidth=b}},getLabelWidthInColumn:function(a){return this.columns[a].labelWidth},getFieldWidthInColumn:function(a){return this.columns[a].fieldWidth},getWidgetsInColumn:function(a){if(this.columns&&
!this.columns[a])return[];var b=c.filter(this.children,function(b){return b.index==a});return c.map(b,function(a){return a.item})},getWidgetsInRow:function(a){if(this.rows&&!this.rows[a])return[];var b=c.filter(this.children,function(b){return b.row==a});return c.map(b,function(a){return a.item})},startup:function(){this.set("labelAlignment",this.labelAlignment);0!=this.children.length&&(this.columns?c.forEach(this.columns,function(a,b){var d=this.getWidgetsInColumn(b);c.forEach(d,function(b){b.set("labelWidth",
a.labelWidth);b.set("fieldWidth",a.fieldWidth)})},this):c.forEach(this.rows,function(a,b){var d=this.getWidgetsInRow(b),e=d.length,f=parseInt(this.rowWidth),i,h,g,f=f-(2<e?21*(e-2)+38:19*e);"vertical"==this.labelAlignment?(i=h=Math.ceil(f/e),g=f-h*(e-1)):(i=Math.ceil(0.4*(f/e)),h=Math.ceil(0.6*(f/e)),g=f-(i+h)*(e-1));c.forEach(d,function(a,b){b==e-1?"vertical"==this.labelAlignment?(a.set("labelWidth",g+"px"),a.set("fieldWidth",g+"px")):(a.set("labelWidth",0.4*g+"px"),a.set("fieldWidth",0.6*g+"px")):
(a.set("labelWidth",i+"px"),a.set("fieldWidth",h+"px"))},this)},this),this._clean(),this.children.sort(function(a,b){return 0<a.row-b.row||a.row==b.row&&a.index>b.index}),c.forEach(this.children,function(a){j.place(a.item.domNode,this.rows[a.row].node,a.index)},this),c.forEach(this.rows,function(a){j.place(a.node,this.containerNode)},this),this.inherited(arguments))},_newRow:function(){return j.create("div",{className:"oneuiFormBodyRow"})},_clean:function(){var a=k(".oneuiFormBodyRow",this.containerNode);
c.forEach(a,function(a){if(a&&a.parentNode){var d=k(".idxComposite",a);c.forEach(d,function(a){a&&a.parentNode&&a.parentNode.removeChild(a)});a.parentNode.removeChild(a)}})}})});