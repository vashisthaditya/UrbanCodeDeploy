//>>built
define("idx/grid/cells","dojo/_base/lang,idx/main,dojo/_base/declare,dojo/keys,dojo/date/locale,dojo/aspect,dojo/_base/event,dojo/dom-construct,dojo/dom-attr,dojo/dom-geometry,dijit/_base/manager,dijit/form/CheckBox,dijit/form/RadioButton,dojox/grid/cells,../form/Select,../form/CheckBoxSelect,../resources,dojo/i18n!../nls/base,dojo/i18n!./nls/base,dojo/i18n!./nls/cells".split(","),function(f,p,g,l,q,i,j,r,h,m,s,n,t,k,u,v,o){var d=f.getObject("grid.cells",!0,p);d._Widget=g("idx.grid.cells._Widget",
k.Cell,{readonly:!1,constructor:function(){this.editable=!1;this._widgets=[]},formatter:function(a,b){var c=this._getWidget(b);c._onChangeActive=!1;c.set("value",a);c._lastValueReported=a;c._onChangeActive=!0;return c},apply:function(a){var b=this._getWidget(a);if(b){var b=b.get("value"),c=this.grid;c.edit.apply();a=c.getItem(a);c.store.setValue(a,this.field,b)}},_getWidget:function(a){var b=this._widgets[a];b||(b=this._widgets[a]=this._createWidget(a));return b},_createWidget:function(){return null},
_resizeWidget:function(a){var b=this._widgets[a];b&&(a=this.getNode(a),a=m.getContentBox(a),m.getMarginBox(b.domNode,{w:a.w-1}))}});d._Widget.markupFactory=function(a,b){k.Cell.markupFactory(a,b);var c=f.trim(h.get(a,"readonly")||"");if(c)b.readonly="true"==c.toLowerCase()};d.CheckBox=d.Checkbox=g("idx.grid.cells.CheckBox",d._Widget,{allCheckable:!1,labelText:"",formatter:function(a,b){var c=o.getResources("idx/grid/cells");if(this.allCheckable){this._headerWidget&&this._headerWidget.domNode&&!this._headerWidget.domNode.firstChild&&
(this._headerWidget.destroy(),delete this._headerWidget);if(!this._headerWidget){var e=this,d=function(a){j.stop(a)},f=this._headerWidget=new n({onClick:function(a){e.checkAll(e._headerWidget.checked);j.stop(a)},onMouseDown:d,onMouseUp:d,title:c.headerCheckBoxLabel});h.set(f.focusNode,"aria-label",c.headerCheckBoxLabel);var e=this,g=this.grid;f.own(i.after(g,"onKeyDown",function(a){a.keyCode==l.SPACE&&g.focus.getHeaderIndex()==e.index&&f._onClick(a)},!0))}if(c=this.getHeaderNode())(d=s.findWidgets(c)[0])||
r.place(this._headerWidget.domNode,c.firstChild,"first");this._headerWidget.checked!=a&&this._headerWidget.set("checked",this.isAllChecked())}d=this._getWidget(b);d.set("checked",a&&"false"!=a);return d},_createWidget:function(a){var b=o.getResources("idx/grid/cells"),c=this,e=this.grid,d=new n({onClick:function(b){c.apply(a);setTimeout(function(){e.focus.findAndFocusGridCell()},0);j.stop(b)},title:b.rowCheckBoxLabel});h.set(d.focusNode,"aria-label",b.rowCheckBoxLabel);d.own(i.after(e,"onKeyDown",
function(b){b.keyCode==l.SPACE&&e.focus.isFocusCell(c,a)&&0>e.focus.getHeaderIndex()&&d._onClick(b)},!0));return d},apply:function(a){var b=this._getWidget(a);if(b){var b=b.checked,c=this.grid;c.edit.apply();a=c.getItem(a);c.store.setValue(a,this.field,b)}},checkAll:function(a){for(var b=this.grid.rowCount,c=0;c<b;c++){var e=this._widgets[c];e&&e.checked!=a&&(e.set("checked",a),this.apply(c))}},isAllChecked:function(){for(var a=this.grid.rowCount,b=0;b<a;b++){var c=this._widgets[b];if(c&&!c.checked)return!1}return!0}});
d.CheckBox.markupFactory=function(a,b){d._Widget.markupFactory(a,b);var c=f.trim(h.get(a,"allCheckable")||"");if(c)b.allCheckable="true"==c.toLowerCase()};d.RowSelector=g("idx.grid.cells.RowSelector",d.CheckBox,{get:function(a){return this.grid.selection.isSelected(a)},formatter:function(){if(!this._selectionChanged)this._selectionChanged=f.hitch(this,this.render),this.grid.own(i.after(this.grid,"onSelectionChanged",this._selectionChanged,!0));return this.inherited(arguments)},apply:function(a){var b=
this._getWidget(a);if(b)(b=b.checked)?this.grid.selection.addToSelection(a):this.grid.selection.deselect(a),this._headerWidget&&this._headerWidget.checked!=b&&this._headerWidget.set("checked",this.isAllChecked())},render:function(){for(var a=!0,b=this.grid.rowCount,c=0;c<b;c++){var e=this._getWidget(c),d=this.get(c);e&&e.checked!=d&&e.set("checked",d);d||(a=!1)}this._headerWidget&&this._headerWidget.checked!=a&&this._headerWidget.set("checked",a)}});d.RowSelector.markupFactory=function(a,b){d.CheckBox.markupFactory(a,
b)};d.RadioButton=g("idx.grid.cells.RadioButton",d.CheckBox,{_selectedIndex:-1,formatter:function(a,b){if(a)this._selectedIndex=b;return this.inherited(arguments)},_createWidget:function(a){var b=this,c=this.grid,e=new t({onClick:function(e){b.apply(a);setTimeout(function(){c.focus.findAndFocusGridCell()},0);j.stop(e)}});e.own(i.after(c,"onKeyDown",function(d){d.keyCode==l.SPACE&&c.focus.isFocusCell(b,a)&&0>c.focus.getHeaderIndex()&&e._onClick(d)},!0));return e},apply:function(a){var b=this._getWidget(a);
if(b){var b=b.checked,c=this.grid;c.edit.apply();var e=this._selectedIndex;b&&0<=e&&e!=a&&(e=c.getItem(e),c.store.setValue(e,this.field,!1));a=c.getItem(a);c.store.setValue(a,this.field,b)}}});d.RadioButton.markupFactory=function(a,b){d.CheckBox.markupFactory(a,b)};d.Select=g("idx.grid.cells.Select",d._Widget,{store:null,placeHolder:"",formatter:function(a,b){var c=this;setTimeout(function(){c._resizeWidget(b)},0);return this.inherited(arguments)},_createWidget:function(a){var b=this,c=this.grid,
e=new u({store:this.store,placeHolder:this.placeHolder,onClick:function(a){j.stop(a)},onChange:function(){b.apply(a);setTimeout(function(){c.focus.findAndFocusGridCell()},0)}});if(!e.toggleDropDown)e.toggleDropDown=function(){this._isShowingNow?this._hideResultList():this._startSearchAll()};e.own(i.after(c,"onKeyDown",function(d){d.keyCode==l.SPACE&&c.focus.isFocusCell(b,a)&&0>c.focus.getHeaderIndex()&&e.toggleDropDown()},!0));return e},setStore:function(a){this.store=a}});d.Select.markupFactory=
function(a,b){d._Widget.markupFactory(a,b);var c=f.trim(h.get(a,"store")||"");if(c)b.store=f.getObject(c);if(c=f.trim(h.get(a,"placeHolder")||""))b.placeHolder=c};d.MultiSelect=g("idx.grid.cells.MultiSelect",d.Select,{get:function(a,b){var c,e=this.grid.store;e.isItem(b)&&(c=e.getValues(b,this.field));return c||[]},apply:function(a){var b=this._getWidget(a);if(b){var b=b.get("value"),c=this.grid;c.edit.apply();a=c.getItem(a);c.store.setValues(a,this.field,b||[])}},_createWidget:function(a){var b=
this,c=this.grid,e=new v({store:this.store,placeHolder:this.placeHolder,onClick:function(a){j.stop(a)},onChange:function(){b.apply(a);setTimeout(function(){c.focus.findAndFocusGridCell()},0)},"class":"dijitSelectFixedWidth"});if(!e.toggleDropDown)e.toggleDropDown=function(){this._isShowingNow?this._hideResultList():this._startSearchAll()};e.own(i.after(c,"onKeyDown",function(d){d.keyCode==l.SPACE&&c.focus.isFocusCell(b,a)&&0>c.focus.getHeaderIndex()&&e.toggleDropDown()},!0));return e}});d.MultiSelect.markupFactory=
function(a,b){d.Select.markupFactory(a,b)};d.Text=g("idx.grid.cells.Text",k.Cell,{textClass:"",placeHolder:"&nbsp;",applyOnBlur:!1,get:function(a,b){var c,d=this.grid.store;d.isItem(b)&&(c=d.getValue(b,this.field));return c||""},formatter:function(a){var b=this.textClass;if(!a)a=this.placeHolder,b=(b?b+" ":"")+"idxGridPlaceHolder";return"<div class='"+b+"'>"+a+"</div>"},formatNode:function(a,b,c){this.inherited(arguments);if(a&&this.applyOnBlur&&this.editable){var d=this;this._handle=i.after(a,"onblur",
function(){setTimeout(function(){d.grid.edit.isEditCell(c,d.index)&&d.grid.edit.apply()},100);d._handle&&(d._handle.remove(),delete d._handle)},!0)}},destroy:function(){this._handle&&(this._handle.remove(),delete this._handle);this.inherited(arguments)}});d.Text.markupFactory=function(a,b){k.Cell.markupFactory(a,b);var c=f.trim(h.get(a,"textClass")||"");if(c)b.textClass=c;if(c=f.trim(h.get(a,"placeHolder")||""))b.placeHolder=c;if(c=f.trim(h.get(a,"applyOnBlur")||""))b.applyOnBlur="true"==c.toLowerCase()};
d.DateTime=g("idx.grid.cells.DateTime",d.Text,{selector:"",formatLength:"medium",formatter:function(a){a&&(arguments[0]=q.format(new Date(a),{selector:this.selector,formatLength:this.formatLength,fullYear:!0}));return this.inherited(arguments)}});d.DateTime.markupFactory=function(a,b){d.Text.markupFactory(a,b);var c=f.trim(h.get(a,"selector")||"");if(c)b.selector=c;if(c=f.trim(h.get(a,"formatLength")||""))b.formatLength=c};d.Empty=g("idx.grid.cells.Empty",k.Cell,{formatter:function(){return""}});
d.Empty.markupFactory=function(a,b){k.Cell.markupFactory(a,b)};return d});