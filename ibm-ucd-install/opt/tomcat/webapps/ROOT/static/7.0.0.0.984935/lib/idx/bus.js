//>>built
define("idx/bus","dojo/_base/lang,idx/main,dojo/_base/json,dojo/_base/connect,dojo/string,dijit/_WidgetBase,dijit/_base/manager,idx/bus/BusMessage,idx/string,idx/util".split(","),function(l,m,r,n,o,k,p,q,i,j){var a=l.getObject("bus",!0,m);a.DEFAULT_BUS_TOPIC="idx.bus";a.NOTIFICATIONS="idx.bus.notifications";a.QUERIES="idx.bus.queries";a.DEBUG="DEBUG";a.INFO="INFO";a.WARNING="WARNING";a.USER_ERROR="USER_ERROR";a.SYSTEM_ERROR="SYSTEM_ERROR";a.ALERT="ALERT";a.CONFIRM="CONFIRM";a.CHOOSE="CHOOSE";a.PROMPT=
"PROMPT";a.publish=function(d,b,c,f,g,e){var e=i.nullTrim(e),h=null,h=null!=e?{topic:e,widget:null}:a._getBusTopic(c),d=new q({scope:d,messageType:b,source:c,broadcast:f,args:g});return a._publish(h,d)};a._publish=function(d,b){for(var c=[],f=[];null!=d&&!(!0==c[d.topic]);){c[d.topic]=!0;f.push(d.topic);n.publish(d.topic,[b]);d=!b.isHandled()||broadcast?a._getPropagateBusTopic(d):null}return b};a.debug=function(d,b,c,f,g,e,h){return a.notify(d,a.DEBUG,b,c,f,g,e,h)};a.info=function(d,b,c,f,g,e,h){return a.notify(d,
a.INFO,b,c,f,g,e,h)};a.warning=function(d,b,c,f,g,e,h){return a.notify(d,a.WARNING,b,c,f,g,e,h)};a.userError=function(d,b,c,f,g,e,h){return a.notify(d,a.USER_ERROR,b,c,f,g,e,h)};a.systemError=function(d,b,c,f,g,e,h){return a.notify(d,a.SYSTEM_ERROR,b,c,f,g,e,h)};a.notify=function(d,b,c,f,g,e,h,i){a.publish(a.NOTIFICATIONS,b,d,!0,{messageTemplate:c,messageArgs:f,messageID:g,internalMessage:e},i);if(h)throw d=(b?b+": ":"")+(g?g+": ":"")+(e?e:o.substitute(c,f)),Error(d);};a._getBusTopic=function(d,b){var c=
b;null==c?c={topic:null,widget:null}:(c.topic=null,c.widget=null);c.widget=d instanceof k?d:j.isNodeOrElement(d)?p.getEnclosingWidget(d):null;if(null!=c.widget&&c.widget._idx_getBusTopic)c.topic=i.nullTrim(c.widget._idx_getBusTopic());for(;null==c.topic&&null!=c.widget;)if(c.widget=a._getParentBusWidget(c.widget),c.widget)c.topic=i.nullTrim(c.widget._idx_getBusTopic());if(null==c.topic)c.topic=a.DEFAULT_BUS_TOPIC,c.widget=null;return c};a._getPropagateBusTopic=function(d){var b=null;d instanceof k&&
a._getBusTopic(d);b=baseResult;d=b.topic;b.topic=null;if(null==b.widget)return null;for(b.widget=a._getParentBusWidget(b.widget);null!=b.widget&&null==b.topic;)if(b=a._getBusTopic(b.widget,b),b.topic==d&&(b.topic=null,null!=b.widget))b.widget=a._getParentBusWidget(b.widget);return null==b.topic||b.topic==d?null:b};a._getParentBusWidget=function(a){for(a=j.getParentWidget(a);null!=a&&(!a._idx_getBusTopic||!a._idx_getPropogateBusTopic);)a=j.getParentWidget(a);return a};return a});